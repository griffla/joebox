!function(o){"use strict";var e,a=!1,i={},t={slide_duration:400,preload_siblings:!0,modal_backdrop_background_color:"#000",modal_backdrop_opacity:.5,modal_backdrop_zindex:10,modal_backdrop_show_duration:300,slide_easing:"swing"},d={init:function(e){this.each(function(a){var i=o.extend(!0,{},t,e);o(this).data("settings",i)}),o("body").on("touchmove",function(){a=!0}).on("touchstart",function(){a=!1}),this.addClass("joebox-gallery").on("mousedown touchend","a img:only-child()",function(e){var i=o(this);if(jQuery.data(document.body,"joebox-gallery",o(this).closest(".joebox-gallery")),!a){e.preventDefault();var t=i.closest(".joebox-item"),n=t.index(),r=jQuery.data(document.body,"joebox-gallery").attr("id"),b=o("#joebox-"+r);if(b.length){var s=jQuery("#joebox-image-"+jQuery.data(document.body,"joebox-gallery").attr("id")+"-"+n);d.joebox_show_modal(),d.joebox_preload_image(s,!1,1,1,1,function(){s.css({width:""}).parent().addClass("active"),d.joebox_toggle_nav_buttons(0,function(){b.show()}),d.joebox_show_target_image(b,n)})}else d.build_joebox(i.parent())}})},build_joebox:function(e){d.joebox_show_modal(),o("#joebox").length||o("body").append('<div id="joebox"><div id="joebox-loader" class="joebox-loader"></div></div>');var i=jQuery('<div id="joebox-'+jQuery.data(document.body,"joebox-gallery").attr("id")+'" class="joebox"><div class="joebox-inner"><a class="joebox-icon joebox-close-icon"><i></i></a><a class="joebox-icon joebox-nav-icon joebox-nav-prev"><i class="joebox-icon-arrow joebox-icon-left"></i></a><a class="joebox-icon joebox-nav-icon joebox-nav-next"><i class="joebox-icon-arrow joebox-icon-right"></i></a><div class="joebox-image-wrapper"><div></div></div></div></div>');jQuery("#joebox").append(i),d.joebox_build_items(i,e),o("body").on("mousedown touchend","#joebox-"+jQuery.data(document.body,"joebox-gallery").attr("id"),function(e){if(!a){var i=o(e.target),t=o(this).find(".joebox-item.active").find("img"),n=parseInt(t.offset().left),r=parseInt(t.offset().top),b=parseInt(t.height()),s=parseInt(t.width());i.hasClass("joebox-nav-icon")||i.hasClass("joebox-icon-arrow")||!(e.pageX<n||e.pageY<r||e.pageX>n+s||e.pageY>r+b)?i.hasClass("joebox-close-icon")&&d.joebox_hide(o(this)):d.joebox_hide(o(this))}})},joebox_build_items:function(e,a){var t=e.find(".joebox-image-wrapper"),n=t.find("div:first-child"),r=t.width(),b=a.closest(".joebox-gallery"),s=jQuery.data(document.body,"joebox-gallery").attr("id"),l=0;b.find(".joebox-item").each(function(){var o=jQuery(this),i=o.find("a").attr("href"),b=i==a.attr("href");n.append('<div id="joebox-item-'+s+"-"+l+'" class="joebox-item '+(b?"active":"")+'" style="left: '+r*l+'px"></div>');var j=t.find("#joebox-item-"+s+"-"+l);j.append('<img class="joebox-image" id="joebox-image-'+s+"-"+l+'" data-joebox-src="'+i+'" style="">');var _=jQuery("#joebox-image-"+s+"-"+l);b||(d.joebox_preload_image(_,!0,0,0,0),_.css({})),b&&(d.joebox_preload_image(_,!1,1,1,1),d.joebox_show_target_image(e,l)),l++});t.find(".joebox-item.active");d.joebox_toggle_nav_buttons(),o(document).off("keyup").on("keyup",function(e){27==e.which||32==e.which?d.joebox_hide(o("#joebox-"+jQuery.data(document.body,"joebox-gallery").attr("id"))):37==e.which?d.joebox_find_slide_in_target_body("prev"):39==e.which&&d.joebox_find_slide_in_target_body("next")}),e.on("click touchend",".joebox-nav-icon",function(o){"touchend"===o.type&&e.off("click");var a=jQuery(this);a.hasClass("joebox-nav-prev")?d.joebox_find_slide_in_target_body("prev"):a.hasClass("joebox-nav-next")&&d.joebox_find_slide_in_target_body("next")}).swipe({swipeStatus:function(o,e,a,t,n,r,b){var s=jQuery("#joebox-"+jQuery.data(document.body,"joebox-gallery").attr("id")),l=s.find(".joebox-image-wrapper");if("start"===e&&(jQuery.data(document.body,"joebox_inner_position",l.css("left")),jQuery.data(document.body,"joebox_item_active",jQuery("#joebox-"+jQuery.data(document.body,"joebox-gallery").attr("id")).find(".joebox-item.active"))),"right"===a&&l.css("left",parseFloat(jQuery.data(document.body,"joebox_inner_position"))+t+"px"),"left"===a&&l.css("left",parseFloat(jQuery.data(document.body,"joebox_inner_position"))-t+"px"),"end"===e){var j=t/n;t>jQuery.data(document.body,"joebox_item_active").width()/2||j>=.3?("right"===a&&(jQuery.data(document.body,"joebox_item_active").prev().length?d.joebox_find_slide_in_target_body("prev"):l.finish().animate({left:parseFloat(jQuery.data(document.body,"joebox_inner_position"))+"px"},i.slide_duration,i.slide_easing)),"left"===a&&(jQuery.data(document.body,"joebox_item_active").next().length?d.joebox_find_slide_in_target_body("next"):l.finish().animate({left:parseFloat(jQuery.data(document.body,"joebox_inner_position"))+"px"},i.slide_duration,i.slide_easing))):l.animate({left:parseFloat(jQuery.data(document.body,"joebox_inner_position"))+"px"},i.slide_duration,i.slide_easing)}},threshold:10})},joebox_show_target_image:function(o,e){var a=o.find(".joebox-image-wrapper"),i=a.width();a.css({left:-(i*e)+"px"})},joebox_find_slide_in_target_body:function(o){var e=jQuery("#joebox-"+jQuery.data(document.body,"joebox-gallery").attr("id")).find(".joebox-item.active"),a=e.next();"prev"===o&&(a=e.prev()),d.joebox_slide_material(a)},joebox_slide_material:function(o){var e=jQuery("#joebox-"+jQuery.data(document.body,"joebox-gallery").attr("id")),a=e.find(".joebox-image-wrapper"),i=a.find(".joebox-item.active");if(o.length){i.removeClass("active");var t=o.addClass("active"),n=t.find("img"),r=i.find("img");jQuery.data(document.body,"joebox_slide_in_img",n),jQuery.data(document.body,"joebox_slide_out_img",r),"undefined"==typeof n.attr("src")?d.joebox_preload_image(n,!1,0,0,1,d.joebox_slide_animation):d.joebox_slide_animation(),d.joebox_toggle_nav_buttons()}},joebox_slide_animation:function(){var o=jQuery.data(document.body,"joebox-gallery").data("settings"),e=jQuery("#joebox-"+jQuery.data(document.body,"joebox-gallery").attr("id")),a=e.find(".joebox-image-wrapper"),i=a.find(".joebox-item.active"),t=parseInt(i.css("left"));jQuery.data(document.body,"joebox_slide_in_img"),jQuery.data(document.body,"joebox_slide_out_img");if(a.finish().animate({left:-t},o.slide_duration,o.slide_easing),o.preload_siblings){var n=i.prev().find("img"),r=i.next().find("img");n.length&&"undefined"==typeof n.attr("src")&&d.joebox_preload_image(n,!0,0,0,1),r.length&&"undefined"==typeof r.attr("src")&&d.joebox_preload_image(r,!0,0,0,1)}},joebox_preload_image:function(o,a,i,t,n,r){var b=o.attr("src");"undefined"==typeof b&&(a||(e=setTimeout(function(){d.joebox_loader_initialise()},200)),n&&o.attr("src",o.attr("data-joebox-src")),o.on("load",function(){if(a||(clearTimeout(e),d.joebox_loader_hide()),o.show(),jQuery.data(document.body,"joebox-gallery").data("settings").preload_siblings){if(i){var n=o.parent().next().find("img");d.joebox_preload_image(n,!0,0,0,1)}if(t){var r=o.parent().prev().find("img");d.joebox_preload_image(r,!0,0,0,1)}}})),"function"==typeof r&&r()},joebox_toggle_nav_buttons:function(o,e){o="undefined"!=typeof o?o:200;var a=jQuery("#joebox-"+jQuery.data(document.body,"joebox-gallery").attr("id")),i=a.find(".joebox-image-wrapper").find(".joebox-item.active");i.next().length?a.find("a.joebox-nav-next").removeClass("disabled"):a.find("a.joebox-nav-next").addClass("disabled"),i.prev().length?a.find("a.joebox-nav-prev").removeClass("disabled"):a.find("a.joebox-nav-prev").addClass("disabled"),"function"==typeof e&&e()},joebox_hide:function(o,e){o.fadeOut(300,function(){"function"==typeof e&&e()}).find(".joebox-item.active").removeClass("active"),d.joebox_loader_hide(),d.hide_modal_backdrop()},joebox_destroy:function(o){d.joebox_hide(o,function(){d.joebox_loader_hide(),o.remove()})},joebox_loader_initialise:function(){o("#joebox-loader").show()},joebox_loader_hide:function(){o("#joebox-loader").hide()},joebox_show_modal:function(){var o=jQuery.data(document.body,"joebox-gallery").data("settings");d.show_modal_backdrop(o.modal_backdrop_show_duration,o.modal_backdrop_opacity,o.modal_backdrop_background_color,o.modal_backdrop_zindex)},show_modal_backdrop:function(o,e,a,i){d.hide_modal_backdrop();var t={};t.opacity=e?e:.5,jQuery('<div id="joebox-modal-backdrop" class="modal-backdrop" style="opacity: 0; '+(a?"background-color: "+a:"")+"; "+(i?"z-index: "+i:"")+'"></div>').appendTo("body").animate(t,{duration:o?o:250,queue:!1})},hide_modal_backdrop:function(o){jQuery("#joebox-modal-backdrop").length&&jQuery("#joebox-modal-backdrop").fadeOut(o?o:200,function(){jQuery(this).remove()})}};o.fn.joebox=function(e){return d[e]?d[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void o.error("Method "+e+" does not exist on jQuery.joebox"):d.init.apply(this,arguments)}}(jQuery);